<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>SkyPortal Status Monitor</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>

    <style>
      body {
          padding: 2rem;
      }
      .service-name {
          font-weight: bold;
      }
      .status_OK {
          color: green;
      }
      .status_FAIL {
          color: red;
      }
      .news {
          padding-top: 2rem;
      }
      .news-time {
          font-weight: bold;
          padding-right: 1rem;
      }
      .news-text {
      }
    </style>
  </head>

  <body>

    <h3>SkyPortal Status Monitor</h3>

    <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
      <thead>
        <tr>
          <th class="mdl-data-table__cell--non-numeric">Service</th>
          <th class="mdl-data-table__cell--non-numeric">Status</th>
          <th class="mdl-data-table__cell--non-numeric">Time</th>
          <th class="mdl-data-table__cell--non-numeric">Additional Information</th>
        </tr>
      </thead>
      <tbody>

        {% for probe, info in probes.items() %}
        <tr>
          <td class="mdl-data-table__cell--non-numeric service-name">{{ probe }}</td>
          <td
            class="mdl-data-table__cell--non-numeric {{
            'status_OK' if info['status_code'] == 0 else 'status_FAIL' }}">
            {{ info['status'] }}
          </td>
          <td class="mdl-data-table__cell--non-numeric">{{ info['time'] }}</td>
          {% if info['extra'] %}
          <td class="mdl-data-table__cell--non-numeric">{{ info['extra'] }}</td>
          {% else %}
          <td></td>
          {% endif %}
        </tr>
        {% endfor %}

      </tbody>

    </table>

    {% if news %}
    <div class="news">
      <h5>Updates</h5>

      <ul class="mdl-list">

        {% for update in news %}

        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">
            <span class="news-time">{{ update['time'] }}</span>
            <span class="news-text">{{ update['message'] }}</span>
          </span>
        </li>

        {% endfor %}

      </ul>
    </div>

    {% endif %}

  </body>

</html>
